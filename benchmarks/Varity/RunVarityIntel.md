# How to run Varity-Intel Programs

## Make the target 
 Under the directory `{pLiner_source_dir}/benchmarks/Varity/Varity-intel`, do 
 ```
 make
 ```



## Run pLiner on the Varity-Intel programs
Navigate to `{pLiner_source_dir}/benchmarks/Varity/Varity-intel` by
```
cd ./benchmarks/Varity/Varity-intel
```
### exclude.json
Note that to run pLiner sucessfully for Varity-Intel, it is needed to have the file `exclude.json` to ask pLiner to skip functions such as `main` and `init_pointer`. The `exclude.json` file should look like
```
{
  "test_1.c": ["initPointer", "main"],
  "test_2.c": ["initPointer", "main"],
  ...
}

```

### pLiner version
Known problem that running pLiner from the dev:lastest will cause compilation error. For now, use the master:lastest instead.



- **Run pLiner on a single program**
   
   Do

   ```
   python {pLiner_source_dir}/scripts/search.py {c_program_dir} "--"
   ```
   
   For example, to run `test_1.c`, and do
   ```
   python  ../../../scripts/search.py test_1.c "--"
   ```
  
- **Run pLiner on all 50 programs**
  
  Do
  ```
  for i in {1..50}
  do
    python ../../../scripts/search.py test_$i.c "--"
  done
  ```

After running pLiner on the program(s), do 
```
make
```
again to make the target for the transfomed program(s).

## Extract pLiner isolation results

Use the script `tool.sh` from `\reference` by
```
./tool.sh
```
`tool.sh` looks at `test_{num}-log.txt` for each program and extract the isolation lines.
The extracted results are stored in `varity-results.txt`.





## Compare numerical results before/after transition
Use the `cmp.sh` to compare numerical results.
```
# Compare one program
./cmp.sh test_1_trans

# Compare all programs
for i in {1..50}
do
    ./cmp.sh test_$i\_trans
    echo
done
```

## Clean files
```
# Files generated by pLiner transfomation
rm *-log.txt
rm *-regions.json 
rm *_trans.c

# Files generated by making targets
rm test_*_*
rm test_*_trans_*
```